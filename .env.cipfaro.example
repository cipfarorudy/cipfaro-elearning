# Variables d'environnement pour la production LWS - cipfaro.fr
# Copiez ce fichier vers .env.production et modifiez les valeurs

# =============================================================================
# CONFIGURATION DOMAINE
# =============================================================================
NEXT_PUBLIC_DOMAIN=cipfaro.fr
NEXT_PUBLIC_API_URL=https://api.cipfaro.fr
NEXT_PUBLIC_WEB_URL=https://cipfaro.fr

# =============================================================================
# BASE DE DONNÉES POSTGRESQL
# =============================================================================
# Remplacez VOTRE_MOT_DE_PASSE_POSTGRES par un mot de passe sécurisé
DATABASE_URL="postgresql://cipfaro:VOTRE_MOT_DE_PASSE_POSTGRES@postgres:5432/cipfaro_db"
POSTGRES_DB=cipfaro_db
POSTGRES_USER=cipfaro
POSTGRES_PASSWORD=VOTRE_MOT_DE_PASSE_POSTGRES

# =============================================================================
# REDIS (pour le cache et les sessions)
# =============================================================================
REDIS_URL=redis://redis:6379

# =============================================================================
# JWT ET SÉCURITÉ
# =============================================================================
# Générez une clé secrète forte (ex: openssl rand -base64 32)
JWT_SECRET=VOTRE_CLE_JWT_SECRETE_DE_32_CARACTERES
JWT_EXPIRES_IN=7d

# Clé de chiffrement pour les données sensibles
ENCRYPTION_KEY=VOTRE_CLE_CHIFFREMENT_32_CARACTERES

# =============================================================================
# EMAIL ET NOTIFICATIONS
# =============================================================================
# Email pour Let's Encrypt SSL
SSL_EMAIL=admin@cipfaro.fr

# Configuration SMTP (optionnel)
SMTP_HOST=smtp.lws.fr
SMTP_PORT=587
SMTP_USER=noreply@cipfaro.fr
SMTP_PASSWORD=VOTRE_MOT_DE_PASSE_EMAIL
SMTP_FROM=CIPFARO ELearning <noreply@cipfaro.fr>

# =============================================================================
# STOCKAGE ET UPLOADS
# =============================================================================
# Répertoire de stockage des fichiers SCORM
UPLOAD_DIR=/app/uploads
MAX_FILE_SIZE=50MB

# Configuration S3/MinIO (optionnel pour stockage externe)
# S3_ENDPOINT=https://s3.cipfaro.fr
# S3_BUCKET=cipfaro-storage
# S3_ACCESS_KEY=VOTRE_ACCESS_KEY
# S3_SECRET_KEY=VOTRE_SECRET_KEY

# =============================================================================
# CONFIGURATION APPLICATIVE
# =============================================================================
NODE_ENV=production
PORT=3000
API_PORT=3001

# Niveau de logs
LOG_LEVEL=info

# Limitation de taux (requests par minute)
RATE_LIMIT_REQUESTS=100
RATE_LIMIT_WINDOW=60000

# =============================================================================
# SCORM ET E-LEARNING
# =============================================================================
# Répertoire de stockage des packages SCORM
SCORM_PACKAGE_DIR=/app/uploads/scorm
SCORM_CONTENT_DIR=/app/public/scorm

# Configuration xAPI (optionnel)
XAPI_ENDPOINT=https://api.cipfaro.fr/xapi
XAPI_VERSION=1.0.3

# =============================================================================
# MONITORING ET OBSERVABILITÉ
# =============================================================================
# Health check endpoint
HEALTH_CHECK_PATH=/health

# Métriques Prometheus (optionnel)
METRICS_ENABLED=true
METRICS_PORT=9090

# =============================================================================
# CORS ET SÉCURITÉ
# =============================================================================
CORS_ORIGIN=https://cipfaro.fr,https://www.cipfaro.fr
CORS_CREDENTIALS=true

# Headers de sécurité
SECURITY_HEADERS_ENABLED=true

# =============================================================================
# BACKUP ET MAINTENANCE
# =============================================================================
# Configuration des sauvegardes automatiques
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *  # Tous les jours à 2h du matin
BACKUP_RETENTION_DAYS=30

# =============================================================================
# VARIABLES DOCKER ET NGINX
# =============================================================================
# Version des images Docker
WEB_IMAGE_TAG=latest
API_IMAGE_TAG=latest

# Configuration Nginx
NGINX_WORKER_PROCESSES=auto
NGINX_WORKER_CONNECTIONS=1024

# =============================================================================
# INSTRUCTIONS DE CONFIGURATION
# =============================================================================
# 1. Copiez ce fichier vers .env.production
# 2. Remplacez TOUS les placeholders (VOTRE_*)
# 3. Générez des clés sécurisées :
#    - JWT_SECRET : openssl rand -base64 32
#    - ENCRYPTION_KEY : openssl rand -base64 32
#    - POSTGRES_PASSWORD : openssl rand -base64 16
# 4. Configurez votre email admin pour SSL
# 5. Testez la configuration avant le déploiement

# =============================================================================
# EXEMPLE DE GÉNÉRATION DE CLÉS SÉCURISÉES
# =============================================================================
# Exécutez ces commandes sur votre VPS LWS :
# 
# JWT_SECRET=$(openssl rand -base64 32)
# ENCRYPTION_KEY=$(openssl rand -base64 32)  
# POSTGRES_PASSWORD=$(openssl rand -base64 16)
#
# echo "JWT_SECRET=$JWT_SECRET"
# echo "ENCRYPTION_KEY=$ENCRYPTION_KEY"
# echo "POSTGRES_PASSWORD=$POSTGRES_PASSWORD"